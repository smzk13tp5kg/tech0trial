import streamlit as st

# ----------------------------------------
# ページ設定
# ----------------------------------------
st.set_page_config(
    page_title="Git 用語辞典",
    layout="wide"
)

st.title("Git 用語ミニ辞典")
st.write("「これって何のこと？どこで使うの？」という Git 用語を一覧・検索できるミニ辞典です。")

# ----------------------------------------
# Git 全体説明（左カラムに表示）
# ----------------------------------------
GIT_OVERVIEW = """
### ◆ OneDrive と Git の違い

#### 1. 管理する単位が違う
**OneDrive**：ファイル単位の過去版を保存（最大500版）  
**Git**：フォルダ全体の“その瞬間の状態”を保存（履歴は無制限）

#### 2. 壊したときに戻せる範囲が違う
**OneDrive**  
- 消したファイルだけ戻せる  
- フォルダ全体の構成までは戻らない  

**Git**  
- フォルダ全体を過去状態に戻せる  
- うっかり削除しても安全  

#### 3. 履歴の作られ方が違う
**OneDrive**：修正前のファイルコピーを丸ごと保存  

**Git**：  
- 変わった部分だけ新しく保存  
- 変わらない部分は過去のデータを再利用  
→ それでも「フォルダ丸ごとのスナップショット」が残る

#### 4. 複数人で作業する仕組みが違う
**OneDrive**：同じファイルを開くと上書きがぶつかりやすい  

**Git**：  
- ブランチ（作業用コピー）を作れる  
- 各自が自分のコピーで自由に作業し、最後にマージ（統合）できる
"""

# ----------------------------------------
# 用語データ（右カラムで切り替わる）
# ----------------------------------------
TERMS = {
    "リポジトリ（repository）": {
        "meaning": "フォルダ全体の履歴を保存する場所（プロジェクトのタイムマシン）。",
        "desc": """
- Git が履歴を保存する場所  
- OneDrive は「ファイル単位」だが、Git は「フォルダ全体」を管理  
- 過去の任意の状態にフォルダごと戻せる  
"""
    },
    "リモートリポジトリ（remote repository）": {
        "meaning": "インターネット上にある共有リポジトリ。",
        "desc": """
- GitHub や Azure DevOps 上にある共有の履歴置き場  
- チームメンバーが push / pull して使う  
"""
    },
    "ローカルリポジトリ（local repository）": {
        "meaning": "自分のPCにある履歴のコピー。",
        "desc": """
- 自分の PC 上にある Git の履歴（.git フォルダ）  
- 作業のほとんどはローカルで完結し、まとまったらリモートに push する  
"""
    },
    "ブランチ（branch）": {
        "meaning": "プロジェクトの“作業用コピー”を並列に持てる仕組み。",
        "desc": """
- フォルダ丸ごとの「作業レーン」  
- main とは別の線路の上で安全に試せる  
- OneDrive のような上書き競合を避けられる  
"""
    },
    "プッシュ（push）": {
        "meaning": "ローカルの履歴をリモートに送ること。",
        "desc": """
- 自分のコミットを GitHub などの共有リポジトリに送る  
- チームへの「成果物提出」に相当  
"""
    },
    "プル（pull）": {
        "meaning": "リモートの変更を取り込み、自分の作業に反映。",
        "desc": """
- `fetch + merge` をまとめて行う操作  
- 他メンバーの作業を自分のブランチに取り込む  
"""
    },
    "クローン（clone）": {
        "meaning": "リモートのリポジトリを丸ごと手元にコピー。",
        "desc": """
- `git clone URL` で実行  
- 履歴すべてを含んだ「完全コピー」  
- 作業を始めるとき最初に行う  
"""
    },
    "コミット（commit）": {
        "meaning": "フォルダ全体の“状態”を保存すること。",
        "desc": """
- プロジェクトのスナップショットを1枚撮るイメージ  
- メッセージ付きで「何をした変更か」を残す  
- OneDrive より強力：フォルダ全体＆無制限  
"""
    },
}

# ----------------------------------------
# 3 カラム構成
# 左：Git説明 / 中：用語選択 / 右：用語解説
# ----------------------------------------
col_left, col_center, col_right = st.columns([1.8, 0.9, 1.8])

# ----------------------------------------
# 左：Git全体の説明（この枠だけスクロール）
# ----------------------------------------
with col_left:
    st.subheader("Git の基本説明")

    # このクラスにだけスクロールを適用するCSS
    st.markdown(
        """
        <style>
        .git-overview-box {
            max-height: 600px;
            overflow-y: auto;
            padding: 15px;
            border: 1px solid #DDD;
            border-radius: 5px;
            background-color: #FAFAFA;
        }
        </style>
        """,
        unsafe_allow_html=True,
    )

    # Markdown + スクロール枠を一度に描画（他のMarkdownには影響しない）
    st.markdown(f'<div class="git-overview-box">{GIT_OVERVIEW}</div>', unsafe_allow_html=True)

# ----------------------------------------
# 中央：用語選択
# ----------------------------------------
with col_center:
    st.subheader("用語を選択")

    # （必要ならここにだけ効くCSSを書く。今はシンプルにしておく）
    selected = st.radio(
        "",
        list(TERMS.keys()),
        index=0
    )

# ----------------------------------------
# 右：用語の説明
# ----------------------------------------
with col_right:
    term = TERMS[selected]
    st.subheader(selected)
    st.markdown(f"**意味：** {term['meaning']}")
    st.markdown("---")
    st.markdown(term["desc"])
